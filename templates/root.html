<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script type="text/javascript" src="https://apis.google.com/js/platform.js" async defer></script>
    <script type="text/javascript" src="{% static 'raphael-min.js' %}"></script>
    <script type="text/javascript" src="{% static 'raphael.chord.js' %}"></script>
    {% include "analytics.html" %}
    <style type="text/css">
        div.smt-header h2.heading_social {
            margin: 0px; padding: 0px;
        }
        a.show_diagram_link {
            background-color: #eeeeff;
            color: #2222aa;
            border: none;
            padding: 3px;
            text-decoration: none;
            border: dotted 2px #ccccff;
        }
        #chord_popup {
            visibility: hidden;
            background-color: #ffffff;
            border: solid 1px;
            padding: 0px;
            margin: 0px;
        }
        #tab_viewer {
            margin: 0px;
            padding: 0px;

            clear: both;
            margin-top: 10px;
            padding-top: 10px;
            overflow: auto;
            line-height: 22px;
        }
    </style>
</head>
<body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.0";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <div data-role="page" class="tab_page">
        {% include "header.html" %}

        <div role="main" class="ui-content jqm-content">

            {% block content %}{% endblock %}
            {% block footer %}
        </div>
    </div>
    {% endblock %}
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
    <div id="chord_popup">
        <a href="#" class="chord_popup_close">x</a>
        <div id="chord_popup_diagram"></div>
    </div>
    <script type="text/javascript">
        function close_chord_popup(e) {
            $('#chord_popup').css('visibility', 'hidden');
            $('#chord_popup_diagram').html('');
        }

        $(document).ready(function(e) {
            $('.show_diagram_link').click(close_chord_popup);
            $('.show_diagram_link').click(function(e) {
                var elem = $( this );
                $('#chord_popup').css('position', 'absolute').css('top', e.pageY-20+'px').css('left', e.pageX+'px')
                    .css('visibility', 'visible');
                $('#chord_popup_diagram').html('');
                var exp = /\s*(([a-g])([#b])?\s?(min|maj|m|dim|5|6|7|maj7|9|maj9|11|13|maj13|min6|min7|min9|min11|min13|sus2|sus4|dim|aug|6\/9|7sus4|7b5|7b9|9sus4|add9|aug9)?)\s*/i;
                var match = exp.exec(elem.html())
                var note = match[2];
                var sf = match[3]
                var modifier = match[4];
                if(modifier == 'm') {
                    modifier = 'min';
                }
                parsed = note;
                if(sf) { parsed += sf; }
                if(modifier) { parsed += ' ' + modifier; }
                Raphael.chord('chord_popup_diagram', parsed).element.setSize(100, 100);
            });
            $('#chord_popup').click(close_chord_popup);

        });

    </script>

</body>
</html>